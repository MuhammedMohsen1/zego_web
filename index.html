<html lang="en">

<head>
  <meta charset="UTF-8">
</head>

<body>
  <div id="root"></div>

  <script src="https://unpkg.com/@zegocloud/zego-uikit-prebuilt/zego-uikit-prebuilt.js"></script>

  <script>
    var zp;
    
    // Function to generate a random user ID
    function generateRandomUserId(length) {
      var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
      var result = '';
      for (var i = 0; i < length; i++) {
        result += characters.charAt(Math.floor(Math.random() * characters.length));
      }
      return result;
    }

    // Function to initialize Zego
    function initZego() {
      const roomID = "a3a18429-3159-40d7-9a21-594e4fe8cb4c"; // Replace with your room ID
      const userID = generateRandomUserId(20); // Replace with your user ID logic
      const userName = "consult test"; // Replace with user's display name
      const appID = 1588161922;
      const serverSecret = "70b700b662f12e892602c841ce7d648a"; 

      // Generate a Kit Token by calling a method.
      const kitToken = ZegoUIKitPrebuilt.generateKitTokenForTest(appID, serverSecret, roomID, userID, userName);
      
      zp = ZegoUIKitPrebuilt.create(kitToken);

      zp.joinRoom({
        container: document.querySelector("#root"),
        scenario: {
          mode: ZegoUIKitPrebuilt.VideoConference,
        },
        showRoomTimer: true,
        showPreJoinView: false,
        turnOnCameraWhenJoining: true,
        showMyCameraToggleButton: true,
        showAudioVideoSettingsButton: true,
        showScreenSharingButton: true,
        screenSharingConfig: {
          resolution: ZegoUIKitPrebuilt.ScreenSharingResolution_720P
        },
        showLeavingView: false,
        showLeaveRoomConfirmDialog: false,
        onJoinRoom: () => {
          console.log("Joined the room");
        },
        onLeaveRoom: () => {
          console.log("Left the room");
        },
        onLiveStart: () => {
          console.log("onLiveStart");
        },
        onLiveEnd: () => {
          console.log("onLiveEnd");
        },
        onUserJoin: () => {
          console.log("onUserJoin");
        },
        onUserLeave: () => {
          console.log("onUserLeave");
        },
      });
    }

    // Listen for messages from the parent window
    window.addEventListener('message', function(event) {
      if (event.data === 'init_zego') {
        initZego();
      }
    });

    // Dispatch the custom event to initialize Zego if needed
    document.addEventListener('DOMContentLoaded', function() {
      var event = new CustomEvent('init_zego');
      document.dispatchEvent(event);
    });

  </script>
</body>

</html>
